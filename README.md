Сервис генерации числового мультипликатора

Этот репозиторий содержит исходный код HTTP-сервиса на Go, который генерирует случайные числовые мультипликаторы для клиента. Основная цель сервиса — обеспечить, чтобы итоговый RTP (Return to Player) на стороне клиента стремился к заданному значению при большом количестве запросов.

Описание алгоритма

Ключевая задача сервиса — не просто сгенерировать случайное число, а сгенерировать его с определенной вероятностью, обеспечивая реалистичную и разнообразную систему выплат. Чтобы RTP клиента стремился к заданному значению, необходимо, чтобы среднее значение выплат на большой дистанции совпадало с этим RTP.

Для решения этой задачи был выбран алгоритм, основанный на использовании динамической таблицы выплат. Это позволяет генерировать не только выигрыш/проигрыш, но и малые, средние и крупные выигрыши с разными вероятностями, что делает игру более интересной для пользователя.

Логика решения:

Сервис на Go (генератор): Сервис принимает запросы и возвращает случайный мультипликатор. При запуске, на основе заданного значения RTP, он динамически рассчитывает вероятности для каждого множителя (например, 2.0, 5.0, 100.0). Сумма произведений каждого мультипликатора на его вероятность в точности равна заданному RTP. Сервис не ведет никакой статистики.

Клиент (аналитик): Клиент отправляет N запросов, получает ответы и сам ведет учет. Он суммирует все полученные мультипликаторы, а затем вычисляет итоговый RTP по формуле: RTP = (Общая сумма выигрышей) / (Количество запросов). Это обеспечивает точный расчет, независимо от количества и типа выигрышей.

Как запустить программу:

Запуск Go сервиса

В первом окне терминала необходимо прописать следующую команду с указанием параметра rtp:

go run ./cmd/main.go -rtp=0.75

Сервис запустится по адресу http://localhost:64333 и будет готов к приему запросов.

Запуск Python клиента для тестирования

Для проверки работы сервиса используется клиентский скрипт на Python.
Если Python не установлен, выполните команду:

python3 -m pip install requests

Затем во втором окне терминала (пока Go-сервис работает) запустите скрипт, указав желаемое количество запросов:

python3 ./cmd/testRPC.py 10000

Скрипт отправит 10,000 запросов и выведет в терминал рассчитанный RTP, который должен быть очень близок к значению, заданному при запуске сервиса.

Пример при запуске команд в терминале:

go run ./cmd/main.go -rtp=0.75

В терминале запуска Python скрипта должны быть примерно следующие значения:

--- Результаты теста ---
Количество запросов: 10000
Количество выигрышных спинов: 915
Общая сумма выигрышей: 7462.00
Рассчитанный RTP: 0.7462
Тест занял: 7.2299 секунды
